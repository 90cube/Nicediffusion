## nicediff 마이그레이션 핵심 방향성

### 우리가 만들려는 것

**nicediff**는 단순한 이미지 생성 도구를 넘어, 사용자의 창작 워크플로우를 이해하고 지원하는 **지능형 창작 플랫폼**으로 진화시키려고 합니다.

### 핵심 설계 철학

1. **모듈식 아키텍처**
   - 기존의 얽혀있는 코드를 완전히 분리
   - 각 기능이 독립적으로 작동하면서도 유기적으로 연결
   - 새 기능 추가 시 기존 코드 수정 최소화

2. **사용자 중심 워크플로우**
   - 단계별 안내 (ui.stepper로 모델 설정 → 생성 작업 분리)
   - 자주 쓰는 설정을 한 번에 적용하는 메타데이터 활용
   - 반복 생성, 배치 작업 등 실제 사용 패턴 반영

3. **반응형 상태 관리**
   - 모든 UI가 중앙 상태(StateManager)를 바라봄
   - 한 곳에서 변경하면 모든 곳에 자동 반영
   - 이벤트 기반으로 느슨하게 연결

### 주요 개선 사항

#### 1. Image Pad의 진화
기존의 단순한 이미지 표시 영역을 **동적 작업 공간**으로 변경:
- **모드별 UI 자동 전환**: 텍스트→이미지, 이미지→이미지, 업스케일 등 각 모드에 최적화된 UI 자동 로드
- **비교 뷰어**: ui.splitter를 활용한 원본/결과 실시간 비교
- **3D 포즈 에디터**: Three.js 통합으로 직접 포즈 조작 가능
- **마스크 편집기**: 인페인팅을 위한 직관적인 그리기 도구

#### 2. 메타데이터 중심 워크플로우
모델의 메타데이터를 적극 활용:
- **원클릭 설정 적용**: 모델 제작자가 권장하는 설정값 한 번에 적용
- **트리거 워드 관리**: 클릭만으로 프롬프트에 추가
- **호환성 자동 체크**: VAE, LoRA 조합 자동 추천

#### 3. 생산성 기능 강화
실제 사용자들이 필요로 하는 기능:
- **반복 생성 토글**: 같은 설정으로 여러 장 생성
- **시드 증가 전략**: 순차/랜덤/고정 선택 가능
- **배치 큐 시스템**: 여러 작업을 예약하고 순차 실행
- **결과물 자동 정리**: 날짜/프로젝트별 폴더 구조

#### 4. 확장성을 위한 플러그인 시스템
- 커스텀 샘플러 추가
- 새로운 후처리 효과
- 커뮤니티 제작 UI 패널
- 외부 서비스 연동 (Discord, 클라우드 저장소 등)

### 구현 우선순위

**Phase 1: 기반 구축**
- StateManager: 모든 상태의 중앙 저장소
- EventBus: 컴포넌트 간 통신 채널
- 기본 UI 레이아웃 (NiceGUI 활용)

**Phase 2: 핵심 기능**
- 모델 관리 서비스 (스캔, 로드, 메타데이터)
- 기본 생성 모드 (txt2img, img2img)
- 동적 Image Pad 시스템

**Phase 3: 고급 기능**
- Three.js 포즈 에디터
- 반복 생성 및 배치 시스템
- 메타데이터 기반 자동화

**Phase 4: 확장성**
- 플러그인 매니저
- 커뮤니티 기능
- 클라우드 동기화

### 기술적 선택 이유

1. **NiceGUI 선택**: 
   - Python 백엔드와 자연스러운 통합
   - 빠른 프로토타이핑
   - 웹 기반으로 크로스 플랫폼 지원

2. **이벤트 기반 아키텍처**:
   - 기능 간 의존성 최소화
   - 새 기능 추가 시 기존 코드 수정 불필요
   - 디버깅 및 모니터링 용이

3. **Three.js 통합**:
   - 3D 포즈 직접 조작으로 사용성 향상
   - 웹 표준 기술로 안정성 확보
   - 풍부한 커뮤니티 리소스 활용 가능

이것이 우리가 추구하는 nicediff의 새로운 모습입니다. 단순한 도구에서 창작 파트너로의 진화를 목표로 합니다.
